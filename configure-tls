#!/usr/bin/env bash

#set -xeuo pipefail

mkdir ${HOST}
openssl genrsa -aes256 -out ${HOST}/${HOST}-ca-key.pem 4096
openssl req -new -x509 -days 365 -key ${HOST}/${HOST}-ca-key.pem -sha256 -out ${HOST}/${HOST}-ca.pem

openssl genrsa -out ${HOST}/${HOST}-server-key.pem 4096

openssl req -subj "/CN=$HOST" -sha256 -new -key ${HOST}/server-key.pem -out ${HOST}/server.csr
